#ifndef PENTEST_H
#define PENTEST_H

#include <QWidget>
#include <QLineEdit>
#include <QTextEdit>
#include <QComboBox>
#include <QProcess>

class Pentest : public QWidget
{
    Q_OBJECT

public:
    explicit Pentest(QWidget *parent = nullptr);

signals:
    void requestNavigateToPage(const QString &pageName);

private slots:
    void runNmapScan();
    void handleScanOutput();
    void handleScanError();
    void scanFinished(int exitCode, QProcess::ExitStatus exitStatus);

private:
    QLineEdit *m_targetInput;
    QComboBox *m_scanTypeCombo;
    QLineEdit *m_portRangeInput;
    QTextEdit *m_outputDisplay;
    QProcess *m_nmapProcess;
    
    QString buildNmapCommand();
};

#endif // PENTEST_H